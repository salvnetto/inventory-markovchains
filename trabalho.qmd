---
title: "Estoques"
subtitle: "Controle de Estoques Utilizando Cadeias de Markov"
author:
  - Salvador Netto (2022040141)
  - Nicolas Monteiro (2022039950)
  - Gustavo Aledi (2022040290)
abstract: ""
lang: pt
format: 
  pdf:
    toc: true
    fig-pos: "H"
    #toc-title: "Summary"
    toc-depth: 3
    #toc-location: right
    number-sections: true
    number-depth: 3
    documentclass: report
    fig-cap-location: top
    geometry:
      - top=3cm
      - left=3cm
      - right=2cm
      - bottom=2cm
execute:
  echo: false
  warning: false
  output: false
---

```{r}
library(tidyverse)
library(markovchain)
library(igraph)
```

```{r}
data = read.csv("datasets/data.csv") %>% select(-X)
data$X.1 = 0
colnames(data) = c(-1:5)
rownames(data) = c(-1:5)

trans_matrix = as.matrix(data)
estados = as.character(c(-1:5))
```

```{r}
cadeia = new("markovchain", states= estados, transitionMatrix= trans_matrix, name= 'Estoque')
```

```{r}
plot(cadeia,
    layout=layout.davidson.harel)
```
```{r}
is.irreducible(cadeia)
is.regular(cadeia)
meanRecurrenceTime(cadeia)
steadyStates(cadeia)
```

```{r}
period(cadeia)

communicatingClasses(cadeia)

recurrentClasses(cadeia)

transientClasses(cadeia)

transientStates(cadeia)

recurrentStates(cadeia)

absorbingStates(cadeia)
```

```{r}
seq = markovchainSequence(n = 100, markovchain = cadeia, t0 = "-1")
```

```{r}
noofVisitsDist(cadeia, 9, "-1")

```

```{r}
meanAbsorptionTime(cadeia)

```

```{r}
transitionProbability(cadeia, "2", "4")

```

```{r}
meanNumVisits(cadeia)
```

```{r}
trans_matrix %*% trans_matrix %*% trans_matrix %*% trans_matrix  %*% trans_matrix %*% trans_matrix 
```


